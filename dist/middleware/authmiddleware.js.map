{"version":3,"sources":["../../src/middleware/authmiddleware.js"],"names":["TOKENTIME","SECRET","authenticate","secret","generateAccessToken","req","res","next","token","sign","id","user","expiresIn","respond","status","json","username","module","exports"],"mappings":";;AAAA;;;;AACA;;;;;;AAGA,IAAMA,YAAY,KAAG,EAAH,GAAM,EAAN,GAAS,EAA3B,C,CAA+B;AAC/B,IAAMC,SAAS,sBAAf,C,CAAuC;;AAEvC,IAAIC,eAAe,0BAAW,EAACC,QAAQF,MAAT,EAAX,CAAnB;;AAEA,IAAIG,sBAAsB,SAAtBA,mBAAsB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5CF,MAAIG,KAAJ,GAAYH,IAAIG,KAAJ,IAAa,EAAzB;AACAH,MAAIG,KAAJ,GAAY,uBAAIC,IAAJ,CAAS;AACnBC,QAAIL,IAAIM,IAAJ,CAASD;AADM,GAAT,EAETT,MAFS,EAED;AACTW,eAAWZ,SADF,CACY;AADZ,GAFC,CAAZ;AAKAO,SAP4C,CAOpC;AACT,CARD;;AAUA,IAAIM,UAAU,SAAVA,OAAU,CAACR,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBJ,UAAKN,IAAIM,IAAJ,CAASK,QADK;AAEnBR,WAAOH,IAAIG;AAFQ,GAArB;AAID,CALD;;AAOAS,OAAOC,OAAP,GAAiB;AACfhB,4BADe;AAEfE,0CAFe;AAGfS;AAHe,CAAjB","file":"authmiddleware.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport expressJwt from 'express-jwt';\r\n\r\n\r\nconst TOKENTIME = 60*60*24*30; // 30 days token TOKENTIME (seconds*minutes*hours*days)\r\nconst SECRET = \"W3 Hav3 th3 kn0w h0w\"; //keep this secrets or people can decode your tokens\r\n\r\nlet authenticate = expressJwt({secret: SECRET});\r\n\r\nlet generateAccessToken = (req, res, next) => {\r\n  req.token = req.token || {};\r\n  req.token = jwt.sign({\r\n    id: req.user.id,\r\n  }, SECRET, {\r\n    expiresIn: TOKENTIME //30 days\r\n  });\r\n  next(); //everytime we see a next means we are talking about a middleware\r\n}\r\n\r\nlet respond = (req, res) => {\r\n  res.status(200).json({\r\n    user:req.user.username,\r\n    token: req.token\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  authenticate,\r\n  generateAccessToken,\r\n  respond\r\n};\r\n"]}